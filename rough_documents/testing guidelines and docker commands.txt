1) to test a specific integration feature:

docker compose run tests pytest tests/integration/test_compose_api.py::test_post_metadata_enqueues_message -v

2) to run only integration test:

docker compose run tests pytest -m integration -v

3) running all tests:

  docker compose run tests pytest

4) running only unit tests (all the non marked tests currently)

  docker compose run tests pytest -m "not integration"

5) failure-path tests (expect 503 when RabbitMQ/Mongo are down). Stop deps first, then run without starting them:

  docker compose stop rabbitmq mongo
  docker compose run --no-deps tests pytest -m failure_path -v

  Then bring deps back: docker compose start rabbitmq mongo

6) worker integration test (message consumed + Mongo persisted metadata):

  docker compose run tests pytest tests/integration/test_worker_integration.py -v